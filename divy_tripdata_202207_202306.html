<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ajay">

<title>Cyclist_data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="divy_tripdata_202207_202306_files/libs/clipboard/clipboard.min.js"></script>
<script src="divy_tripdata_202207_202306_files/libs/quarto-html/quarto.js"></script>
<script src="divy_tripdata_202207_202306_files/libs/quarto-html/popper.min.js"></script>
<script src="divy_tripdata_202207_202306_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="divy_tripdata_202207_202306_files/libs/quarto-html/anchor.min.js"></script>
<link href="divy_tripdata_202207_202306_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="divy_tripdata_202207_202306_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="divy_tripdata_202207_202306_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="divy_tripdata_202207_202306_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="divy_tripdata_202207_202306_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cyclist_data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ajay </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="loading-tidyverse-and-gt-packages" class="level3">
<h3 class="anchored" data-anchor-id="loading-tidyverse-and-gt-packages">Loading <code>tidyverse</code> and <code>gt</code> packages</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loading-data-of-previous-12-months" class="level3">
<h3 class="anchored" data-anchor-id="loading-data-of-previous-12-months">Loading data of previous 12 months</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>trpdata_july_2022<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202207-divvy-tripdata/202207-divvy-tripdata.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trpdata_aug_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202208-divvy-tripdata/202208-divvy-tripdata.csv"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>trpdata_sept_2022<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202209-divvy-tripdata/202209-divvy-publictripdata.csv"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>trpdata_oct_2022<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202210-divvy-tripdata/202210-divvy-tripdata_raw.csv"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>trpdata_nov_2022<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202211-divvy-tripdata/202211-divvy-tripdata.csv"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>trpdata_dec_2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202212-divvy-tripdata/202212-divvy-tripdata.csv"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>trpdata_jan_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202301-divvy-tripdata/202301-divvy-tripdata.csv"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>trpdata_feb_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202302-divvy-tripdata/202302-divvy-tripdata.csv"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>trpdata_mar_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202303-divvy-tripdata/202303-divvy-tripdata.csv"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>trpdata_apr_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202304-divvy-tripdata/202304-divvy-tripdata.csv"</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>trpdata_may_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202305-divvy-tripdata/202305-divvy-tripdata.csv"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>trpdata_june_2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"F:/Data_Sci/Cap_Stone_Project/Cyclist_trip_data/202306-divvy-tripdata/202306-divvy-tripdata.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combining-all-the-monthly-data-to-one-previous-year-datadata_prev_year." class="level3">
<h3 class="anchored" data-anchor-id="combining-all-the-monthly-data-to-one-previous-year-datadata_prev_year.">Combining all the monthly data to one previous year data(<code>data_prev_year</code>).</h3>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_prev_year <span class="ot">&lt;-</span> <span class="fu">rbind</span>(trpdata_july_2022, trpdata_aug_2022,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                   trpdata_sept_2022, trpdata_oct_2022,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   trpdata_nov_2022, trpdata_dec_2022,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                   trpdata_jan_2023, trpdata_feb_2023,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                   trpdata_mar_2023, trpdata_apr_2023,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                   trpdata_may_2023, trpdata_june_2023)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_prev_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,779,444
Columns: 13
$ ride_id            &lt;chr&gt; "954144C2F67B1932", "292E027607D218B6", "5776585258…
$ rideable_type      &lt;chr&gt; "classic_bike", "classic_bike", "classic_bike", "cl…
$ started_at         &lt;dttm&gt; 2022-07-05 08:12:47, 2022-07-26 12:53:38, 2022-07-…
$ ended_at           &lt;dttm&gt; 2022-07-05 08:24:32, 2022-07-26 12:55:31, 2022-07-…
$ start_station_name &lt;chr&gt; "Ashland Ave &amp; Blackhawk St", "Buckingham Fountain …
$ start_station_id   &lt;chr&gt; "13224", "15541", "15541", "15541", "TA1307000117",…
$ end_station_name   &lt;chr&gt; "Kingsbury St &amp; Kinzie St", "Michigan Ave &amp; 8th St"…
$ end_station_id     &lt;chr&gt; "KA1503000043", "623", "623", "TA1307000164", "TA13…
$ start_lat          &lt;dbl&gt; 41.90707, 41.86962, 41.86962, 41.86962, 41.89147, 4…
$ start_lng          &lt;dbl&gt; -87.66725, -87.62398, -87.62398, -87.62398, -87.626…
$ end_lat            &lt;dbl&gt; 41.88918, 41.87277, 41.87277, 41.79526, 41.93625, 4…
$ end_lng            &lt;dbl&gt; -87.63851, -87.62398, -87.62398, -87.59647, -87.652…
$ member_casual      &lt;chr&gt; "member", "casual", "casual", "casual", "member", "…</code></pre>
</div>
</div>
<ul>
<li>Checking and counting “NA” in each column of the dataframe.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>na_in_cols <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span> <span class="fu">map</span>(is.na) <span class="sc">%&gt;%</span> <span class="fu">map</span>(sum) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>na_in_cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           ride_id      rideable_type         started_at           ended_at 
                 0                  0                  0                  0 
start_station_name   start_station_id   end_station_name     end_station_id 
            857860             857992             915655             915796 
         start_lat          start_lng            end_lat            end_lng 
                 0                  0               5795               5795 
     member_casual 
                 0 </code></pre>
</div>
</div>
<ul>
<li><p>As NA’s are not present in the <code>started_at</code> and <code>ended_at</code> we don’t need to bother about writing <code>na.rm</code> during aggregation.</p></li>
<li><p>Finding the length of rides taken by riders by making a new column <code>ride_length</code> in minutes and making sure that the <code>ride_length</code> is not negative by using <code>if_else</code> function. Eliminating stations where station names and longitude and latitude co-ordinates are not present.</p></li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_prev_year <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ride_length =</span> <span class="fu">difftime</span>(ended_at, started_at,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">units =</span> <span class="st">"min"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ride_length =</span> <span class="fu">as.numeric</span>(ride_length)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ride_length =</span> <span class="fu">if_else</span>(ride_length <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, ride_length)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_name <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> end_station_name <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(start_lat) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(start_lng) <span class="sc">&amp;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(end_lat) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(end_lng)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ride_length)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_prev_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,409,335
Columns: 14
$ ride_id            &lt;chr&gt; "86CD09DA24761714", "27024CD08288BD45", "029D853B5C…
$ rideable_type      &lt;chr&gt; "electric_bike", "electric_bike", "classic_bike", "…
$ started_at         &lt;dttm&gt; 2022-07-20 16:21:48, 2022-07-30 23:42:46, 2022-07-…
$ ended_at           &lt;dttm&gt; 2022-07-20 16:21:48, 2022-07-30 23:42:46, 2022-07-…
$ start_station_name &lt;chr&gt; "Racine Ave &amp; Fullerton Ave", "Albany Ave &amp; 26th St…
$ start_station_id   &lt;chr&gt; "TA1306000026", "15691", "chargingstx5", "chargings…
$ end_station_name   &lt;chr&gt; "Racine Ave &amp; Fullerton Ave", "Albany Ave &amp; 26th St…
$ end_station_id     &lt;chr&gt; "TA1306000026", "15691", "chargingstx5", "chargings…
$ start_lat          &lt;dbl&gt; 41.92556, 41.84452, 41.94335, 41.94335, 41.94335, 4…
$ start_lng          &lt;dbl&gt; -87.65859, -87.70209, -87.67067, -87.67067, -87.670…
$ end_lat            &lt;dbl&gt; 41.92556, 41.84448, 41.94335, 41.94335, 41.94335, 4…
$ end_lng            &lt;dbl&gt; -87.65840, -87.70201, -87.67067, -87.67067, -87.670…
$ member_casual      &lt;chr&gt; "member", "casual", "member", "member", "casual", "…
$ ride_length        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
<ul>
<li><p>A total of 1.1796011^{6} minutes were ridden by both casual and membership holders.</p></li>
<li><p>Aggregating data to see <strong>“Average minutes per ride”</strong> grouped by “bike type” and “rider type” after removing rides less than 2 minutes (As rides less than 2 minutes tend to have the same start and stop stations.).</p></li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_prev_year_aggregate <span class="ot">&lt;-</span> data_prev_year<span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ride_id, rideable_type, member_casual, started_at, ended_at,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         ride_length, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ride_length <span class="sc">&gt;=</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">"Number of Rides"</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Ride Length"</span> <span class="ot">=</span> <span class="fu">sum</span>(ride_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Max Ride Length"</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">max</span>(ride_length), <span class="dv">2</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Avg Ride Length in Minutes"</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(ride_length), <span class="dv">2</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(member_casual, rideable_type)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">"Avg Ride Length in Minutes"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Average length of Rides"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">member_casual =</span> <span class="st">"Rider type"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">rideable_type =</span> <span class="st">"Bike type"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>data_prev_year_aggregate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="uzcqwsmrha" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uzcqwsmrha table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uzcqwsmrha thead, #uzcqwsmrha tbody, #uzcqwsmrha tfoot, #uzcqwsmrha tr, #uzcqwsmrha td, #uzcqwsmrha th {
  border-style: none;
}

#uzcqwsmrha p {
  margin: 0;
  padding: 0;
}

#uzcqwsmrha .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uzcqwsmrha .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uzcqwsmrha .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uzcqwsmrha .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uzcqwsmrha .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uzcqwsmrha .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uzcqwsmrha .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uzcqwsmrha .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uzcqwsmrha .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uzcqwsmrha .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uzcqwsmrha .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uzcqwsmrha .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uzcqwsmrha .gt_spanner_row {
  border-bottom-style: hidden;
}

#uzcqwsmrha .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uzcqwsmrha .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uzcqwsmrha .gt_from_md > :first-child {
  margin-top: 0;
}

#uzcqwsmrha .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uzcqwsmrha .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uzcqwsmrha .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uzcqwsmrha .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uzcqwsmrha .gt_row_group_first td {
  border-top-width: 2px;
}

#uzcqwsmrha .gt_row_group_first th {
  border-top-width: 2px;
}

#uzcqwsmrha .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uzcqwsmrha .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uzcqwsmrha .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uzcqwsmrha .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uzcqwsmrha .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uzcqwsmrha .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uzcqwsmrha .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uzcqwsmrha .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uzcqwsmrha .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uzcqwsmrha .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uzcqwsmrha .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uzcqwsmrha .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uzcqwsmrha .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uzcqwsmrha .gt_left {
  text-align: left;
}

#uzcqwsmrha .gt_center {
  text-align: center;
}

#uzcqwsmrha .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uzcqwsmrha .gt_font_normal {
  font-weight: normal;
}

#uzcqwsmrha .gt_font_bold {
  font-weight: bold;
}

#uzcqwsmrha .gt_font_italic {
  font-style: italic;
}

#uzcqwsmrha .gt_super {
  font-size: 65%;
}

#uzcqwsmrha .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uzcqwsmrha .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uzcqwsmrha .gt_indent_1 {
  text-indent: 5px;
}

#uzcqwsmrha .gt_indent_2 {
  text-indent: 10px;
}

#uzcqwsmrha .gt_indent_3 {
  text-indent: 15px;
}

#uzcqwsmrha .gt_indent_4 {
  text-indent: 20px;
}

#uzcqwsmrha .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Average length of Rides</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Rider type">Rider type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Bike type">Bike type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Number of Rides">Number of Rides</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Ride Length">Ride Length</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Max Ride Length">Max Ride Length</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Avg Ride Length in Minutes">Avg Ride Length in Minutes</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="member_casual" class="gt_row gt_left">member</td>
<td headers="rideable_type" class="gt_row gt_left">classic_bike</td>
<td headers="Number of Rides" class="gt_row gt_right">1630991</td>
<td headers="Ride Length" class="gt_row gt_right">21996488</td>
<td headers="Max Ride Length" class="gt_row gt_right">1497.87</td>
<td headers="Avg Ride Length in Minutes" class="gt_row gt_right">13.49</td></tr>
    <tr><td headers="member_casual" class="gt_row gt_left">casual</td>
<td headers="rideable_type" class="gt_row gt_left">classic_bike</td>
<td headers="Number of Rides" class="gt_row gt_right">781530</td>
<td headers="Ride Length" class="gt_row gt_right">19383358</td>
<td headers="Max Ride Length" class="gt_row gt_right">1497.75</td>
<td headers="Avg Ride Length in Minutes" class="gt_row gt_right">24.80</td></tr>
    <tr><td headers="member_casual" class="gt_row gt_left">casual</td>
<td headers="rideable_type" class="gt_row gt_left">electric_bike</td>
<td headers="Number of Rides" class="gt_row gt_right">709649</td>
<td headers="Ride Length" class="gt_row gt_right">11372659</td>
<td headers="Max Ride Length" class="gt_row gt_right">479.98</td>
<td headers="Avg Ride Length in Minutes" class="gt_row gt_right">16.03</td></tr>
    <tr><td headers="member_casual" class="gt_row gt_left">member</td>
<td headers="rideable_type" class="gt_row gt_left">electric_bike</td>
<td headers="Number of Rides" class="gt_row gt_right">984688</td>
<td headers="Ride Length" class="gt_row gt_right">10968684</td>
<td headers="Max Ride Length" class="gt_row gt_right">480.00</td>
<td headers="Avg Ride Length in Minutes" class="gt_row gt_right">11.14</td></tr>
    <tr><td headers="member_casual" class="gt_row gt_left">casual</td>
<td headers="rideable_type" class="gt_row gt_left">docked_bike</td>
<td headers="Number of Rides" class="gt_row gt_right">136794</td>
<td headers="Ride Length" class="gt_row gt_right">6899998</td>
<td headers="Max Ride Length" class="gt_row gt_right">32035.45</td>
<td headers="Avg Ride Length in Minutes" class="gt_row gt_right">50.44</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>We can clearly observe that <strong>member</strong> riders have more number of rides with both <strong>classic and electric bikes</strong> while the average ride length is high with <strong>casual</strong> riders. While the maximum ride lengths did not differ by much.</p>
<ul>
<li>Calculating and visualizing “Average ride length” by “Rider type”.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>average_ride_by_rideable_type <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Rider type"</span> <span class="ot">=</span> member_casual, <span class="st">"Bike type"</span> <span class="ot">=</span> rideable_type) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ride_length =</span> <span class="fu">sum</span>(ride_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ride_count =</span> <span class="fu">n</span>(),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_ride_length =</span> ride_length<span class="sc">/</span>ride_count,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Rider type</span><span class="st">`</span>, <span class="st">`</span><span class="at">Bike type</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="st">`</span><span class="at">Rider type</span><span class="st">`</span>, avg_ride_length)) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Bike type</span><span class="st">`</span>), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bike type"</span>, <span class="at">y =</span> <span class="st">"Avg Length of Ride(Minutes)"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title  =</span> <span class="st">"Avg ride length by Bike type"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>average_ride_by_rideable_type</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="divy_tripdata_202207_202306_files/figure-html/Plot-Average%20ride%20length-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above graph clearly shows that members average ride length between bike types doesn’t differ much for <strong>member</strong> riders but differs with <strong>casual</strong> riders upto <strong>8 minutes</strong>.</p>
<ul>
<li>Calculating and visualizing ride patterns in a week for number of rides.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rideable_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"classic_bike"</span>, <span class="st">"electric_bike"</span>, <span class="st">"docked_bike"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rides_on_days <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rideable_type <span class="sc">!=</span> <span class="st">"docked_bike"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(started_at, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rideable_type =</span> <span class="fu">factor</span>(rideable_type, <span class="at">levels =</span> rideable_order)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">wday</span>(started_at, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>))) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> member_casual), <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>month, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day of the Week"</span>, <span class="at">y =</span> <span class="st">"Number of rides"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Riding pattrens on week days of each month"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"From July-2022 to June-2023"</span>) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>rides_on_days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="divy_tripdata_202207_202306_files/figure-html/plot-Riding%20pattrens%20in%20weekdays-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above graph clearly shows how the number of rides change due to seasons. In winters the number of riders decrease very drastically because of temperature and snow. While in Summers the number of rides are its peak.</p>
<ul>
<li>Comparing variation in ride lengths of average and total ride lengths by bike type.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rides_on_days_len <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">wday</span>(started_at, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(started_at, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ride_count =</span> <span class="fu">n</span>(),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">ride_length =</span> <span class="fu">sum</span>(ride_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(month, day, member_casual)) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(day, ride_length))<span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> member_casual), <span class="at">position =</span> <span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>month, <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>rides_on_days_len</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="divy_tripdata_202207_202306_files/figure-html/Riding%20pattrens%20in%20week%20days%20based%20on%20ride_length-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>rides_on_days_len_avg <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">wday</span>(started_at, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(started_at, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ride_count =</span> <span class="fu">n</span>(),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_ride_length =</span> <span class="fu">mean</span>(ride_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(month, day, member_casual)) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(day, avg_ride_length))<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> member_casual), <span class="at">position =</span> <span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>month, <span class="at">ncol =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>rides_on_days_len_avg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="divy_tripdata_202207_202306_files/figure-html/Riding%20pattrens%20in%20week%20days%20based%20on%20ride_length-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The <strong>ride length</strong> is varying across months and seasons just as number of rides but <strong>average ride length</strong> is not fluctuating that much.</p>
<ul>
<li>Removing “NA” and blanks from the stations columns.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data_prev_year <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(start_station_name) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(end_station_name) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_name <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> end_station_name <span class="sc">!=</span> <span class="st">""</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>         started_at <span class="sc">!=</span> ended_at) </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_prev_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,409,072
Columns: 14
$ ride_id            &lt;chr&gt; "029D853B5C38426E", "C1D6D749139CB6C0", "D3E7C0B68E…
$ rideable_type      &lt;chr&gt; "classic_bike", "classic_bike", "classic_bike", "cl…
$ started_at         &lt;dttm&gt; 2022-07-26 20:07:33, 2022-07-26 20:08:04, 2022-07-…
$ ended_at           &lt;dttm&gt; 2022-07-26 19:59:34, 2022-07-26 19:59:34, 2022-07-…
$ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Roscoe St*", "Lincoln Ave &amp; Roscoe S…
$ start_station_id   &lt;chr&gt; "chargingstx5", "chargingstx5", "chargingstx5", "ch…
$ end_station_name   &lt;chr&gt; "Lincoln Ave &amp; Roscoe St*", "Lincoln Ave &amp; Roscoe S…
$ end_station_id     &lt;chr&gt; "chargingstx5", "chargingstx5", "chargingstx5", "ch…
$ start_lat          &lt;dbl&gt; 41.94335, 41.94335, 41.94335, 41.94335, 41.93945, 4…
$ start_lng          &lt;dbl&gt; -87.67067, -87.67067, -87.67067, -87.67067, -87.663…
$ end_lat            &lt;dbl&gt; 41.94335, 41.94335, 41.94335, 41.94335, 41.93948, 4…
$ end_lng            &lt;dbl&gt; -87.67067, -87.67067, -87.67067, -87.67067, -87.663…
$ member_casual      &lt;chr&gt; "member", "member", "casual", "casual", "member", "…
$ ride_length        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
<ul>
<li>Making a new column to identify travelled stations.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_prev_year <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stations_travelled =</span> <span class="fu">paste</span>(start_station_name, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"-"</span>, end_station_name))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_prev_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,409,072
Columns: 15
$ ride_id            &lt;chr&gt; "029D853B5C38426E", "C1D6D749139CB6C0", "D3E7C0B68E…
$ rideable_type      &lt;chr&gt; "classic_bike", "classic_bike", "classic_bike", "cl…
$ started_at         &lt;dttm&gt; 2022-07-26 20:07:33, 2022-07-26 20:08:04, 2022-07-…
$ ended_at           &lt;dttm&gt; 2022-07-26 19:59:34, 2022-07-26 19:59:34, 2022-07-…
$ start_station_name &lt;chr&gt; "Lincoln Ave &amp; Roscoe St*", "Lincoln Ave &amp; Roscoe S…
$ start_station_id   &lt;chr&gt; "chargingstx5", "chargingstx5", "chargingstx5", "ch…
$ end_station_name   &lt;chr&gt; "Lincoln Ave &amp; Roscoe St*", "Lincoln Ave &amp; Roscoe S…
$ end_station_id     &lt;chr&gt; "chargingstx5", "chargingstx5", "chargingstx5", "ch…
$ start_lat          &lt;dbl&gt; 41.94335, 41.94335, 41.94335, 41.94335, 41.93945, 4…
$ start_lng          &lt;dbl&gt; -87.67067, -87.67067, -87.67067, -87.67067, -87.663…
$ end_lat            &lt;dbl&gt; 41.94335, 41.94335, 41.94335, 41.94335, 41.93948, 4…
$ end_lng            &lt;dbl&gt; -87.67067, -87.67067, -87.67067, -87.67067, -87.663…
$ member_casual      &lt;chr&gt; "member", "member", "casual", "casual", "member", "…
$ ride_length        &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ stations_travelled &lt;chr&gt; "Lincoln Ave &amp; Roscoe St* - Lincoln Ave &amp; Roscoe St…</code></pre>
</div>
</div>
<ul>
<li>Finding which route is traveled most by <strong>casual riders</strong>.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>most_travelled_routes_casual <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(member_casual <span class="sc">==</span> <span class="st">"casual"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ride_count =</span> <span class="fu">n</span>(),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_ride_length =</span> <span class="fu">round</span>(<span class="fu">mean</span>(ride_length), <span class="dv">2</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> <span class="fu">c</span>(stations_travelled)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(ride_count))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(most_travelled_routes_casual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  stations_travelled                                  ride_count avg_ride_length
  &lt;chr&gt;                                                    &lt;int&gt;           &lt;dbl&gt;
1 Streeter Dr &amp; Grand Ave - Streeter Dr &amp; Grand Ave         9698            39.6
2 DuSable Lake Shore Dr &amp; Monroe St - DuSable Lake S…       6584            33.4
3 DuSable Lake Shore Dr &amp; Monroe St - Streeter Dr &amp; …       4840            27.1
4 Michigan Ave &amp; Oak St - Michigan Ave &amp; Oak St             4292            44.6
5 Millennium Park - Millennium Park                         3884            37.4
6 Montrose Harbor - Montrose Harbor                         2711            48.3</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NROW</span>(most_travelled_routes_casual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 130660</code></pre>
</div>
</div>
<p><strong>Streeter Dr &amp; Grand Ave - Streeter Dr &amp; Grand Ave</strong> stands to be the most popular station with <strong>9698 rides</strong> by <strong>casual</strong> riders.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  stations_travelled                    ride_count total_ride_length ride_length
  &lt;chr&gt;                                      &lt;int&gt;             &lt;dbl&gt;       &lt;dbl&gt;
1 Ellis Ave &amp; 60th St - University Ave…       6153            25936.        4.22
2 University Ave &amp; 57th St - Ellis Ave…       5786            26634.        4.6 
3 Ellis Ave &amp; 60th St - Ellis Ave &amp; 55…       5676            28427.        5.01
4 Ellis Ave &amp; 55th St - Ellis Ave &amp; 60…       5347            27187.        5.08
5 State St &amp; 33rd St - Calumet Ave &amp; 3…       4156            18014.        4.33
6 Calumet Ave &amp; 33rd St - State St &amp; 3…       4027            15887.        3.95</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 145104</code></pre>
</div>
</div>
<p><strong>Ellis Ave &amp; 60th St - University Ave &amp; 57th St</strong> stands as the most traveled route by <strong>member</strong> riders with <strong>6153</strong> rides per anum.</p>
<ul>
<li>Finding which station has most ride starting points and which station has most ending points.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>most_starting_points <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ride_count =</span> <span class="fu">n</span>(),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> start_station_name) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(start_station_name, ride_count) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(ride_count, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>most_starting_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   start_station_name                 ride_count
   &lt;chr&gt;                                   &lt;int&gt;
 1 Streeter Dr &amp; Grand Ave                 65892
 2 DuSable Lake Shore Dr &amp; Monroe St       37939
 3 Michigan Ave &amp; Oak St                   36036
 4 DuSable Lake Shore Dr &amp; North Blvd      35091
 5 Wells St &amp; Concord Ln                   33250
 6 Clark St &amp; Elm St                       32751
 7 Kingsbury St &amp; Kinzie St                31876
 8 Millennium Park                         30917
 9 Theater on the Lake                     29600
10 Wells St &amp; Elm St                       28063</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>most_starting_points<span class="sc">$</span>ride_count <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 361415</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>most_ending_points <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ride_count =</span> <span class="fu">n</span>(),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">.by =</span> end_station_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(end_station_name, ride_count)  <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(ride_count, <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>most_ending_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   end_station_name                   ride_count
   &lt;chr&gt;                                   &lt;int&gt;
 1 Streeter Dr &amp; Grand Ave                 67536
 2 DuSable Lake Shore Dr &amp; North Blvd      38026
 3 Michigan Ave &amp; Oak St                   36976
 4 DuSable Lake Shore Dr &amp; Monroe St       36806
 5 Wells St &amp; Concord Ln                   33814
 6 Clark St &amp; Elm St                       32325
 7 Millennium Park                         32046
 8 Kingsbury St &amp; Kinzie St                31058
 9 Theater on the Lake                     30214
10 Wells St &amp; Elm St                       28212</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>most_ending_points<span class="sc">$</span>ride_count <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 367013</code></pre>
</div>
</div>
<p><strong>Streeter Dr &amp; Grand Ave</strong> found to be the most popular station as most rides start and end at that station.</p>
<ul>
<li>Finding all the stations and number of total unique stations.</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>unique_start_stations_name <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_name <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(start_station_name)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>unique_end_station_name <span class="ot">&lt;-</span> data_prev_year <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(end_station_name <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(end_station_name)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>unique_stations <span class="ot">&lt;-</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">union</span>(unique_end_station_name<span class="sc">$</span>end_station_name,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        unique_start_stations_name<span class="sc">$</span>start_station_name)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(unique_stations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lincoln Ave &amp; Roscoe St*"    "Southport Ave &amp; Belmont Ave"
[3] "Leavitt St &amp; Chicago Ave"    "Clark St &amp; Armitage Ave"    
[5] "Streeter Dr &amp; Grand Ave"     "Clark St &amp; Montrose Ave"    </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NROW</span>(unique_stations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1791</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>